(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d44e5ee"],{"13eb":function(t,e,i){"use strict";var a=i("69e9"),n=i.n(a);n.a},"504c":function(t,e,i){var a=i("0d58"),n=i("6821"),r=i("52a7").f;t.exports=function(t){return function(e){var i,s=n(e),o=a(s),c=o.length,l=0,u=[];while(c>l)r.call(s,i=o[l++])&&u.push(t?[i,s[i]]:s[i]);return u}}},"69e9":function(t,e,i){},"75db":function(t,e,i){"use strict";i.r(e);var a,n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dayActivityRoot"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.noActivity,expression:"noActivity"}],staticClass:"empty"},[t._v("当前日期没有活动")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.noActivity,expression:"!noActivity"}],staticClass:"dayActivity"},[i("div",{staticClass:"activityNameList"},[i("span",[t._v("当日活动列表")]),t._l(t.activityNameList,function(e,a){return i("div",{key:a,staticClass:"listBoard"},[t._l(e,function(e,n){return i("div",{key:n,staticClass:"listItem",class:""!==t.activityKey?e!==t.activityNameList[t.activityKey][t.activityFirstIndex]?"":"activeItem":"",on:{click:function(i){return t.showActivityInfo(e,a,n)}}},[t._v(t._s(e))])}),e.length<4?i("div",{style:{textAlign:"right",marginTop:"0.3rem"}},[i("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(i){return t.addActivity(t.key,e)}}})]):t._e()],2)}),i("div",{style:{textAlign:"center",marginTop:"0.3rem",width:"100%",borderTop:"1.2px solid #ACACAC"}},[i("i",{staticClass:"el-icon-circle-plus",on:{click:t.addDivingWork}})])],2),t.activityInfo?i("div",{staticClass:"infoForm"},[i("activity-info",{attrs:{activityInfo:t.activityInfo}})],1):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:t.paginations.currentCoralList,expression:"paginations.currentCoralList"}],staticClass:"fileArea"},[t._l(t.paginations.currentCoralList,function(e,a){return i("div",{key:a,staticClass:"list"},[i("file-item",{attrs:{showActivityData:e},on:{click:function(i){return t.toDetail(t.selectActivity,e)}}})],1)}),i("div",{staticClass:"page"},[i("el-pagination",{attrs:{"hide-on-single-page":"","current-page":t.paginations.page_index,layout:t.paginations.layout,total:t.paginations.total,"page-size":t.paginations.page_size},on:{"current-change":t.handleCurrentChange}})],1)],2)]),i("el-dialog",{attrs:{title:"新建残枝作业",width:"600px",visible:t.showAdd,"append-to-body":"","show-close":!1},on:{"update:visible":function(e){t.showAdd=e}}},[i("el-form",{attrs:{model:t.newWorkForm}},[i("el-form-item",[i("el-col",{attrs:{span:2}},[t._v(" ")]),i("el-col",{style:{textAlign:"center"},attrs:{span:6}},[i("span",[t._v("日期")])]),i("el-col",{attrs:{span:16}},[i("p",{style:{color:"gray",fontSize:"1.1rem"}},[t._v(t._s(t.newWorkForm.time))])])],1),i("el-form-item",[i("el-col",{attrs:{span:2}},[t._v(" ")]),i("el-col",{style:{textAlign:"center"},attrs:{span:6}},[i("span",[t._v("区域")])]),i("el-col",{attrs:{span:16}},[i("p",{style:{color:"gray",fontSize:"1.1rem"}},[t._v(t._s(t.newWorkForm.address))])])],1),i("el-form-item",[i("el-col",{attrs:{span:2}},[t._v(" ")]),i("el-col",{style:{textAlign:"center"},attrs:{span:6}},[i("span",[t._v("残枝作业时间")])]),i("el-col",{attrs:{span:16}},[i("el-input",{style:{width:"70%"},attrs:{type:"number",min:"1",max:"24",placeholder:"请输入1-24之间的整数值",size:"mini"},model:{value:t.newWorkForm.selectHour,callback:function(e){t.$set(t.newWorkForm,"selectHour",t._n(e))},expression:"newWorkForm.selectHour"}})],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"danger",disabled:!t.newWorkForm.selectHour},on:{click:t.submitNewWork}},[t._v("确定")]),i("el-button",{on:{click:function(e){t.showAdd=!1}}},[t._v("取消")])],1)],1)],1)},r=[],s=i("bd86"),o=(i("7f7f"),i("96cf"),i("3b8d")),c=(i("28a5"),i("ac4d"),i("8a81"),i("ac6a"),i("cebc")),l=i("c1df"),u=i.n(l),d=i("e050"),p=i("2f62"),v=i("4ec3"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fileItem",on:{click:function(e){return t.$emit("click")}}},[i("div",{staticClass:"imgArea"},[i("el-image",{staticStyle:{width:"6rem",height:"4.5rem"},attrs:{src:t.showActivityData.imgUrl,fit:"fill",lazy:""}})],1),i("div",{staticClass:"information"},[i("span",[t._v("珊瑚编号："+t._s(t.showActivityData.coralNum))]),i("span",[t._v("属种："+t._s(t.showActivityData.species))]),i("span",[t._v("状态："+t._s(t.showActivityData.state))])]),i("span",{staticClass:"detail"},[t._v("详情 >")])])},m=[],h={props:{showActivityData:Object},data:function(){return{}}},y=h,g=(i("13eb"),i("2877")),b=Object(g["a"])(y,f,m,!1,null,"a99c107a",null),A=b.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"infoRoot"},[i("div",{staticClass:"bottonArea"},[t.ifEdit?i("div",[i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:t.submitEdit}},[t._v("提交")])],1):i("div",[i("i",{staticClass:"el-icon-s-operation",on:{click:t.editActivity}}),i("i",{staticClass:"el-icon-delete",style:{cursor:"pointer"},on:{click:t.deleteActivity}})])]),i("div",{staticClass:"infoBoard"},[i("h2",{style:{color:"#FF6B6B"}},[t._v("活动详情")]),i("div",{staticClass:"infoBody"},[i("el-col",{attrs:{span:3}},[t._v(" ")]),i("el-col",{attrs:{span:18}},t._l(t.formList,function(e,a){return i("div",{key:a,staticClass:"formItem"},[i("el-col",{attrs:{span:6}},[i("span",[t._v(t._s(e.title))])]),i("el-col",{attrs:{span:3}},[t._v(" ")]),i("el-col",{attrs:{span:15}},[/参与人员/.test(e.title)&&t.ifEdit?i("span",[i("el-input",{ref:"input",refInFor:!0,attrs:{placeholder:"请输入",size:"mini"},model:{value:t.members,callback:function(e){t.members=e},expression:"members"}})],1):/备注/.test(e.title)&&t.ifEdit?i("span",[i("el-input",{style:{marginBottom:"1vw"},attrs:{type:"textarea",placeholder:"请输入",autosize:{minRows:4,maxRows:10}},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1):i("span",[t._v(t._s(e.data))])]),i("br")],1)}),0),i("el-col",{attrs:{span:3}},[t._v(" ")])],1)])])},k=[],x=(i("8615"),{props:{activityInfo:{type:Object}},data:function(){return{ifEdit:!1,members:"",remarks:"",formTitle:[{title:"活动编号",data:""},{title:"活动时间",data:""},{title:"参与人员",data:""},{title:"活动类型",data:""},{title:"采集区域",data:""},{title:"珊瑚数量",data:""},{title:"品种数量",data:""},{title:"备注",data:""}]}},computed:{formList:function(){var t=this.formTitle,e=Object.values(this.activityInfo),i=!0,a=!1,n=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0)for(var o=r.value,c=0,l=e;c<l.length;c++){var u=l[c];o.data=u,e.shift(u);break}}catch(d){a=!0,n=d}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}return t}},methods:{changeFocus:function(){this.$nextTick(function(){this.$refs.input[0].focus()})},editActivity:function(){this.ifEdit=!this.ifEdit,this.ifEdit&&this.changeFocus()},deleteActivity:function(){},submitEdit:function(){this.editActivity()}},mounted:function(){this.members=this.activityInfo.totalMembers,this.remarks=this.activityInfo.remarks}}),_=x,I=(i("dfd8"),Object(g["a"])(_,w,k,!1,null,"b348330a",null)),C=I.exports,D=(a={components:{"activity-info":C,"file-item":A},computed:{},data:function(){return{activityNameList:[],selectActivity:"",activityInfo:{activityNum:"",activityTime:"",totalMembers:"",activityType:"",gatherArea:"",coralQuantity:0,varietyQuantity:0,remarks:"-"},coralList:[],activityFirstIndex:0,activityKey:"",showAdd:!1,newWorkForm:{},paginations:{currentCoralList:[],page_index:1,total:0,page_size:4,layout:"prev, pager, next"},activityArr:[],noActivity:!1}}},Object(s["a"])(a,"computed",Object(c["a"])({},Object(p["d"])(["workIdArr"]))),Object(s["a"])(a,"watch",{workIdArr:function(){console.log(this.workIdArr),this.getActivity()}}),Object(s["a"])(a,"methods",Object(c["a"])({},Object(p["c"])(["setCalendarShowActivity"]),{showActivityInfo:function(t,e,i){this.selectActivity=t;var a=this.activityArr[e][i];console.log(e,i,a),this.activityInfo.activityNum=a.principle.ExtendData.activity_number,this.activityInfo.activityTime=a.principle.ExtendData.timestamp,this.activityInfo.totalMembers=a.principle.ExtendData.participants,this.activityInfo.activityType=a.principle.ExtendData.type,this.activityInfo.gatherArea=this.$route.query.address,this.activityInfo.coralQuantity="",this.activityInfo.varietyQuantity="",this.activityInfo.remarks=a.principle.ExtendData.comment,this.activityFirstIndex=i,this.activityKey=e;var n=this.getAllRecord(a.principle.SpaId),r=!0,s=!1,o=void 0;try{for(var c,l=n[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var u=c.value,d=u.principle.SpaId,p=u.principle.ExtendData.czda_spaid,v=this.getRecordImgId(d);this.getRecordImgUrl(v[0]),this.getDanAnData(p)}}catch(f){s=!0,o=f}finally{try{r||null==l.return||l.return()}finally{if(s)throw o}}},handleCurrentChange:function(t){this.setpaginations(t,this.paginations.page_size)},toDetail:function(t,e){var i=t.split("-");this.$router.push({name:"result".concat(i[0]),params:{result:"detail"},query:{time:i[2],address:i[1],activityType:i[0]}}),console.log(t),console.log(e)},setpaginations:function(t,e){this.paginations.total=this.coralList.length,this.paginations.currentCoralList=this.coralList.slice((t-1)*e,t*e)},addDivingWork:function(){this.newWorkForm={time:u()(this.$route.query.time,"YYYYMMDD").format("YYYY年MM月DD日"),address:this.$route.query.address,selectHour:""},this.showAdd=!0},addActivity:function(t,e){console.log(t),console.log(e);var i=t.split("-");this.$router.push({name:"newActivity",params:{existActivity:e},query:{time:i[1],address:i[0]}})},submitNewWork:function(){console.log(this.newWorkForm)},getActivity:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,i,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.activityArr=[],this.activityNameList=[],0!==this.workIdArr.length){t.next=5;break}return this.noActivity=!0,t.abrupt("return");case 5:e=regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=d["a"],i.Jobs[0].MasterSpaId=a.workIdArr[e],t.next=4,Object(v["h"])(i,"/tree/select").then(function(t){if(200===t.data.status)if(t.data.response){a.noActivity=!1,a.activityArr[e]=t.data.response.CZHD.objects;var i=[],n=!0,r=!1,s=void 0;try{for(var o,c=a.activityArr[e][Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l=o.value;i.push(l.principle.ExtendData.activity_number)}}catch(u){r=!0,s=u}finally{try{n||null==c.return||c.return()}finally{if(r)throw s}}a.activityNameList.push(i)}else a.noActivity=!0});case 4:case"end":return t.stop()}},t)}),i=0;case 7:if(!(i<this.workIdArr.length)){t.next=12;break}return t.delegateYield(e(i),"t0",9);case 9:i++,t.next=7;break;case 12:this.showActivityInfo(this.activityArr[0][0].principle.ExtendData.activity_number,0,0),console.log("活动",this.activityArr);case 14:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getAllRecord:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=d["l"],a={},i.Jobs[0].MasterSpaId=e,t.next=5,Object(v["h"])(i,"/tree/select").then(function(t){console.log(t),200===t.data.status&&t.data.response&&(a=t.data.response.CZJL.objects)});case 5:return t.abrupt("return",a);case 6:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),getDanAnData:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var i,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=d["f"],a=this,i.Jobs[0].CZDASpaId=e,i.Jobs[0].Where[0].Operator.Value=e,n={},t.next=7,Api.reqApi(i,"/tree/select").then(function(t){if(200===t.data.status&&t.data.response)a.Refactoring(t.data.response.CZDA.objects[0])});case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getRecordImgId:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this,i=ENTITY.P04,i.Jobs[0].MasterSpaId=e,a=[],t.next=6,Api.reqApi(i,"/tree/select").then(function(t){if(console.log("图片节点:",t),200===t.data.status&&t.data.response)for(var e=t.data.response.CZZP.objects,i=0;i<e.length;++i){var a={url:e[i].principle.ExtendFileData.file_id};_inforImgUrlId.push(a)}}).catch(function(t){});case 6:return console.log("img数组:",a),t.abrupt("return",a);case 8:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getRecordImgUrl:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i="",t.next=3,Api.reqApi({file_id:e},"/file/get").then(function(t){200===t.data.status&&t.data.response&&(i=t.data.response.url)});case 3:return console.log("img数组url:",i),t.abrupt("return",i);case 5:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),Refactoring:function(t){var e=t.principle.ExtendData,i={};if(t.fks)for(var a=t.fks,n=0;n<a.length;n++)Object.assign(i,a[n]);for(var r in i["SpaId"]=t.principle.SpaId,i["CreateAt"]=t.principle.CreateAt,e)i[r]=e[r];var s=i.PYZD.extenddata.number+"-";return null==i.YX?(s+=i.MP.extenddata.name+"-",s+=i.FQ.extenddata.name+"-"):s+=i.YX.extenddata.name+"-",s+=i.haopai_color+"-"+i.haopai_number,i.title=s,i.type=i.ORDER.extenddata.name+"-"+i.FAMILY.extenddata.name+"-"+i.GENUS.extenddata.name,i}})),Object(s["a"])(a,"mounted",function(){this.getActivity()}),Object(s["a"])(a,"beforeRouteEnter",function(t,e,i){i(function(t){})}),a),j=D,R=(i("aa25"),Object(g["a"])(j,n,r,!1,null,"7e52cf18",null));e["default"]=R.exports},8615:function(t,e,i){var a=i("5ca1"),n=i("504c")(!1);a(a.S,"Object",{values:function(t){return n(t)}})},aa25:function(t,e,i){"use strict";var a=i("f724"),n=i.n(a);n.a},b004:function(t,e,i){},dfd8:function(t,e,i){"use strict";var a=i("b004"),n=i.n(a);n.a},f724:function(t,e,i){}}]);
//# sourceMappingURL=chunk-3d44e5ee.d7825ad9.js.map